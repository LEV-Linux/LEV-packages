# Template file for 'lev-dmenu'
pkgname=lev-dmenu
version=1.0
wrksrc="${pkgname}-${version}"
revision=1
makedepends="libXinerama-devel libXft-devel freetype-devel"
short_desc="LEV Linux's fork of the dynamic menu"
maintainer="SalahDin Ahmed Salh Rezk <salah2112004@gmail.com>"
license="MIT"
homepage="http://lev-linux.github.io/"
distfiles="https://github.com/LEV-Linux/lev-dmenu/archive/refs/tags/v${version}.tar.gz"
checksum=f25d16a20c2697265868db0f183a6dfc8955e6c81f5438bd78564b7e0e10f863

post_patch() {
	sed -i -e '/CFLAGS/{s/-Os//;s/=/+=/}' \
		-e '/LDFLAGS/{s/-s//;s/=/+=/}' config.mk
}

do_build() {
	[ -e ${FILESDIR}/config.h ] && cp ${FILESDIR}/config.h config.h
	sed -i -e "s|^FREETYPEINC|#FREETYPEINC|g" \
		-e "s|^X11INC|#X11INC|g" \
		-e "s|^X11LIB|#X11LIB|g" config.mk

	x11inc=$XBPS_CROSS_BASE/usr/include/X11
	x11lib=$XBPS_CROSS_BASE/usr/lib
	freetypeinc=$XBPS_CROSS_BASE/usr/include/freetype2
	make CC="$CC" ${makejobs} X11INC=$x11inc X11LIB=$x11lib FREETYPEINC=$freetypeinc
}

do_install() {
	make PREFIX=/usr DESTDIR=${DESTDIR} install
	vlicense LICENSE
}
